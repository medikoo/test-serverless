service: test-plugin-serverless-step-functions

provider:
  name: aws
  runtime: nodejs12.x
  region: us-east-1
  stage: dev
  versionFunctions: false
  apiGateway:
    shouldStartNameWithService: true

functions:
  function:
    handler: index.handler
    events:
      - http:
          path: foo
          method: GET
      - http:
          path: foo
          method: POST

stepFunctions:
  stateMachines:
    testMachine:
      definition:
        StartAt: FirstState
        States:
          FirstState:
            Type: Task
            Resource:
              Fn::GetAtt: [entry, Arn]
            Next: mapped_task
          mapped_task:
            Type: Map
            Iterator:
              StartAt: FirstMapTask
              States:
                FirstMapTask:
                  Type: Task
                  Resource:
                    Fn::GetAtt: [mapTask, Arn]
                  End: true
            End: true
  validate: true # enable pre-deployment definition validation (disabled by default)

plugins:
  - serverless-step-functions
